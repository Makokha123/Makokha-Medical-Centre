{% extends "base.html" %}

{% block content %}
<!-- Add this to the head section of all your base templates -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<div class="dashboard-container">
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Clinic Logo">
            <h3>Receptionist Panel</h3>
        </div>
        <ul class="sidebar-menu">
            <li><a href="{{ url_for('receptionist_dashboard') }}" class="active"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
            <li><a href="{{ url_for('receptionist_patients') }}"><i class="fas fa-procedures"></i> Patients</a></li>
            <li><a href="{{ url_for('receptionist_billing') }}"><i class="fas fa-cash-register"></i> Billing</a></li>
            <li><a href="#"><i class="fas fa-calendar-alt"></i> Appointments</a></li>
            <li><a href="#"><i class="fas fa-file-invoice"></i> Invoices</a></li>
        </ul>
    </div>
    
    <div class="main-content">
        <div class="top-bar">
            <button class="sidebar-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            <div class="user-info">
                <span>{{ current_user.username }}</span>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-user-circle"></i></button>
                    <div class="dropdown-content">
                        <a href="#"><i class="fas fa-user"></i> Profile</a>
                        <a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="content">
            <h2>Receptionist Dashboard</h2>
            
            <div class="dashboard-widgets">
                <div class="widget">
                    <div class="widget-header">
                        <h3><i class="fas fa-procedures"></i> Patients</h3>
                    </div>
                    <div class="widget-body">
                        <div class="widget-item">
                            <span class="widget-label">Today's Patients:</span>
                            <span class="widget-value">{{ today_patients }}</span>
                        </div>
                        <div class="widget-item">
                            <span class="widget-label">Active Patients:</span>
                            <span class="widget-value">{{ active_patients }}</span>
                        </div>
                        <div class="widget-actions">
                            <a href="{{ url_for('receptionist_patients') }}" class="btn btn-primary">
                                <i class="fas fa-user-plus"></i> New Patient
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="widget">
                    <div class="widget-header">
                        <h3><i class="fas fa-money-bill-wave"></i> Financial</h3>
                    </div>
                    <div class="widget-body">
                        <div class="widget-item">
                            <span class="widget-label">Today's Sales:</span>
                            <span class="widget-value">${{ "%.2f"|format(today_sales) }}</span>
                        </div>
                        <div class="widget-item">
                            <span class="widget-label">Outstanding Bills:</span>
                            <span class="widget-value">${{ "%.2f"|format(outstanding_bills) }}</span>
                        </div>
                    </div>
                </div>
                
                <div class="widget">
                    <div class="widget-header">
                        <h3><i class="fas fa-calendar-alt"></i> Appointments</h3>
                    </div>
                    <div class="widget-body">
                        <div class="widget-item">
                            <span class="widget-label">Today's Appointments:</span>
                            <span class="widget-value">
                                {% if today_appointments is defined %}
                                    {{ today_appointments }}
                                {% else %}
                                    0
                                {% endif %}
                            </span>
                        </div>
                        <div class="widget-item">
                            <span class="widget-label">Pending Confirmation:</span>
                            <span class="widget-value">
                                {% if pending_appointments is defined %}
                                    {{ pending_appointments }}
                                {% else %}
                                    0
                                {% endif %}
                            </span>
                        </div>
                        <div class="widget-actions">
                            <a href="#" class="btn btn-primary">
                                <i class="fas fa-calendar-plus"></i> New Appointment
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="quick-actions">
                <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                <div class="action-buttons">
                    <a href="{{ url_for('receptionist_patients') }}" class="btn btn-action">
                        <i class="fas fa-user-plus"></i>
                        <span>Register Patient</span>
                    </a>
                    <a href="{{ url_for('receptionist_billing') }}" class="btn btn-action">
                        <i class="fas fa-file-invoice"></i>
                        <span>Create Invoice</span>
                    </a>
                    <a href="{{ url_for('receptionist_patients') }}" class="btn btn-action">
                        <i class="fas fa-search"></i>
                        <span>Find Patient</span>
                    </a>
                    <a href="#" class="btn btn-action">
                        <i class="fas fa-print"></i>
                        <span>Print Reports</span>
                    </a>
                </div>
            </div>
            
            <div class="recent-transactions">
                <h3><i class="fas fa-history"></i> Recent Transactions</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Patient</th>
                            <th>Amount</th>
                            <th>Payment Method</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for sale in recent_sales %}
                        <tr>
                            <td>{{ sale.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                            <td>
                                {% if sale.patient %}
                                    {{ decrypt_data(sale.patient.name) }}
                                {% else %}
                                    Walk-in Customer
                                {% endif %}
                            </td>
                            <td>${{ "%.2f"|format(sale.total_amount) }}</td>
                            <td>{{ sale.payment_method|capitalize if sale.payment_method else 'Cash' }}</td>
                            <td>
                                <span class="status-badge completed">
                                    Completed
                                </span>
                            </td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="5" class="text-center">No recent transactions</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- DataTables and other JS libraries -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap4.min.js"></script>


<script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('collapsed');
}
</script>
{% endblock %}